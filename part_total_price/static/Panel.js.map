{"version":3,"file":"Panel.js","sources":["../../frontend/src/Panel.tsx"],"sourcesContent":["// Import for type checking\nimport {\n  checkPluginVersion,\n  type InvenTreePluginContext\n} from '@inventreedb/ui';\nimport { Alert, Flex, Paper, Stack, Table, Text, Title } from '@mantine/core';\n\n// This is the function which is called by InvenTree to render the actual panel component\nexport function renderPartTotalPricePanel(context: InvenTreePluginContext) {\n  checkPluginVersion(context);\n\n  const total = context['context']['total_price'];\n  const okTotal = context['context']['ok_total_price'];\n  const damagedTotal = context['context']['damaged_total_price'];\n  const currency = context['context']['currency'];\n  const mixed = context['context']['mixed_currency'];\n  const totalStock = context['context']['total_stock'];\n  const okStock = context['context']['ok_stock'];\n  const damagedStock = context['context']['damaged_stock'];\n  const locationsData = context['context']['locations_data'] || {};\n\n  const locationsArray = Object.values(locationsData).sort((a: any, b: any) => {\n    // Put \"No Location\" items at the end\n    if (a.location_id === null && b.location_id !== null) return 1;\n    if (a.location_id !== null && b.location_id === null) return -1;\n\n    const nameA = (a.location_path || a.location_name || '').toLowerCase();\n    const nameB = (b.location_path || b.location_name || '').toLowerCase();\n    return nameA.localeCompare(nameB);\n  });\n\n  return (\n    <>\n      <Stack>\n        {locationsArray.length > 0 && (\n          <Paper withBorder p='md'>\n            <Title order={4} mb='sm'>\n              Stock by Location\n            </Title>\n            <Table striped highlightOnHover>\n              <Table.Thead>\n                <Table.Tr>\n                  <Table.Th>Location</Table.Th>\n                  <Table.Th>Total</Table.Th>\n                  <Table.Th>OK</Table.Th>\n                  <Table.Th>Damaged</Table.Th>\n                </Table.Tr>\n              </Table.Thead>\n              <Table.Tbody>\n                {locationsArray.map((location: any, index: number) => (\n                  <Table.Tr\n                    key={location.location_id ?? `no-location-${index}`}\n                  >\n                    <Table.Td>\n                      <Text fw={500}>\n                        {location.location_path || location.location_name}\n                      </Text>\n                    </Table.Td>\n                    <Table.Td>\n                      {Number(location.total).toLocaleString()}\n                    </Table.Td>\n                    <Table.Td>\n                      <Text c='green'>\n                        {Number(location.ok).toLocaleString()}\n                      </Text>\n                    </Table.Td>\n                    <Table.Td>\n                      <Text c='red'>\n                        {Number(location.damaged).toLocaleString()}\n                      </Text>\n                    </Table.Td>\n                  </Table.Tr>\n                ))}\n              </Table.Tbody>\n            </Table>\n          </Paper>\n        )}\n\n        <Flex>\n          <Alert title='Total Stock'>\n            {totalStock ? `${totalStock}` : 'None'}\n          </Alert>\n          <Alert title='Outlets Total'>{okStock ? `${okStock}` : 'None'}</Alert>\n          <Alert title='Total Breakage'>\n            {damagedStock ? `${damagedStock}` : 'None'}\n          </Alert>\n          <Alert title='Total Amount'>\n            {mixed && (\n              <div>Mixed currencies detected; showing partial sum.</div>\n            )}\n            {total\n              ? `${currency ?? ''} ${Number(total).toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`\n              : 'None'}\n          </Alert>\n          <Alert title='Outlet Total Amount'>\n            {okTotal\n              ? `${currency ?? ''} ${Number(okTotal).toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`\n              : 'None'}\n          </Alert>\n          <Alert title='Breakages Total Amount'>\n            {damagedTotal\n              ? `${currency ?? ''} ${Number(damagedTotal).toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`\n              : 'None'}\n          </Alert>\n        </Flex>\n      </Stack>\n    </>\n  );\n}\n"],"names":["Alert","renderPartTotalPricePanel","context","checkPluginVersion","total","okTotal","damagedTotal","currency","mixed","totalStock","okStock","damagedStock","locationsData","locationsArray","a","b","nameA","nameB","Stack","Paper","Title","Table","location","index","Text","Flex"],"mappings":"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"}